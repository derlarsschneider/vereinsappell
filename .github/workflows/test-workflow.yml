name: Test Workflow

on:
  push:
    branches:
    - test

jobs:
  build:
    runs-on: macos-latest

    env:
      ANDROID_APP_ID: 1:336568095877:android:f757f959bbe6c96be8c5ec
      IOS_APP_ID: 1:336568095877:ios:5b61a9b5162f57d1e8c5ec
      TESTER_GROUP: Schuetzenlust

    steps:
    - name: 📥 Checkout Repository
      uses: actions/checkout@v4

    - name: 🕒 Set Version
      id: version
      run: |
        BUILD_NAME=$(date +"%y.%m.%d")
        BUILD_NUMBER=$(date +"%H%M")
        echo "BUILD_NAME=$BUILD_NAME" >> $GITHUB_ENV
        echo "BUILD_NUMBER=$BUILD_NUMBER" >> $GITHUB_ENV
        echo "📦 Version ist ${BUILD_NAME}+${BUILD_NUMBER}"

    - name: 🔥 Setup Firebase CLI
      run: npm install -g firebase-tools

    - name: 🔐 Authenticate Firebase CLI
      run: |
        echo "${{ secrets.FIREBASE_CI }}" > ${{ runner.temp }}/firebase-key.json
        firebase projects:list
      env:
        GOOGLE_APPLICATION_CREDENTIALS: ${{ runner.temp }}/firebase-key.json
